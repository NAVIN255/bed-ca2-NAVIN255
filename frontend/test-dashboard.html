<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Dashboard | Magical Wellness Challenge</title>
    <link rel="stylesheet" href="css/magical-theme.css">
    <link rel="stylesheet" href="css/components/notifications.css">
</head>
<body>
    <div class="container">
        <div class="card magical-glow" style="margin: 2rem auto; max-width: 800px;">
            <h1 class="card-title">üß™ Dashboard Function Test</h1>
            <p class="card-subtitle">Test all dashboard functions without backend dependency</p>
            
            <div class="grid grid-2" style="gap: 1rem; margin: 2rem 0;">
                <button class="btn btn-primary" onclick="testCreateModal()">
                    üåü Test Create Modal
                </button>
                <button class="btn btn-success" onclick="testGamificationSection()">
                    üõí Test Shop Section
                </button>
                <button class="btn btn-warning" onclick="testProgressSection()">
                    üìä Test Progress Section
                </button>
                <button class="btn btn-info" onclick="testNotifications()">
                    üîî Test Notifications
                </button>
                <button class="btn btn-secondary" onclick="testFilterFunction()">
                    üîç Test Filter Function
                </button>
                <button class="btn btn-danger" onclick="testErrorHandling()">
                    ‚ö†Ô∏è Test Error Handling
                </button>
            </div>

            <div id="test-results" class="card" style="margin-top: 2rem;">
                <h3>Test Results:</h3>
                <div id="results-content">
                    <p>Click buttons above to test functions...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Load all scripts -->
    <script src="js/utils/domUtils.js"></script>
    <script src="js/utils/validation.js"></script>
    <script src="js/utils/formatUtils.js"></script>
    <script src="js/utils/errorHandler.js"></script>
    <script src="js/services/APIService.js"></script>

    <script>
        // Mock API service for testing
        window.apiService = {
            getToken: () => 'test-token',
            clearTokens: () => console.log('Tokens cleared'),
            getChallenges: () => Promise.resolve([
                { challenge_id: 1, challenge: "Test Challenge", skillpoints: 10 }
            ]),
            createChallenge: (data) => Promise.resolve({ id: 1, ...data })
        };

        // Mock auth function
        window.requireAuth = () => true;

        // Test functions
        function testCreateModal() {
            if (typeof openCreateChallengeModal === 'function') {
                openCreateChallengeModal();
                logResult('‚úÖ Create Modal function works');
            } else {
                logResult('‚ùå Create Modal function not found');
            }
        }

        function testGamificationSection() {
            if (typeof showGamificationSection === 'function') {
                showGamificationSection();
                logResult('‚úÖ Gamification Section function works');
            } else {
                logResult('‚ùå Gamification Section function not found');
            }
        }

        function testProgressSection() {
            if (typeof showProgressSection === 'function') {
                showProgressSection();
                logResult('‚úÖ Progress Section function works');
            } else {
                logResult('‚ùå Progress Section function not found');
            }
        }

        function testNotifications() {
            if (typeof ErrorHandler !== 'undefined') {
                ErrorHandler.showSuccess('Test success message! üéâ');
                ErrorHandler.showError('Test error message! ‚ö†Ô∏è');
                ErrorHandler.showInfo('Test info message! ‚ÑπÔ∏è');
                logResult('‚úÖ Notification system works');
            } else {
                logResult('‚ùå ErrorHandler not found');
            }
        }

        function testFilterFunction() {
            if (typeof filterChallenges === 'function') {
                filterChallenges();
                logResult('‚úÖ Filter function works');
            } else {
                logResult('‚ùå Filter function not found');
            }
        }

        function testErrorHandling() {
            if (typeof ErrorHandler !== 'undefined') {
                ErrorHandler.handleAPIError(new Error('Test API error'), 'test context');
                logResult('‚úÖ Error handling works');
            } else {
                logResult('‚ùå Error handling not found');
            }
        }

        function logResult(message) {
            const resultsContent = document.getElementById('results-content');
            const p = document.createElement('p');
            p.textContent = message;
            p.style.margin = '0.5rem 0';
            resultsContent.appendChild(p);
        }

        // Check what functions are available
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                logResult('=== Function Availability Check ===');
                logResult(`openCreateChallengeModal: ${typeof openCreateChallengeModal}`);
                logResult(`showGamificationSection: ${typeof showGamificationSection}`);
                logResult(`showProgressSection: ${typeof showProgressSection}`);
                logResult(`filterChallenges: ${typeof filterChallenges}`);
                logResult(`ErrorHandler: ${typeof ErrorHandler}`);
                logResult(`ValidationUtils: ${typeof ValidationUtils}`);
                logResult(`APIService: ${typeof APIService}`);
                logResult(`apiService: ${typeof apiService}`);
            }, 1000);
        });
    </script>

    <!-- Load dashboard script last -->
    <script src="js/dashboard.js"></script>
</body>
</html>